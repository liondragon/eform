{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type": "object",
    "required": [
        "id",
        "version",
        "title",
        "success",
        "email",
        "fields",
        "submit_button_text"
    ],
    "additionalProperties": false,
    "properties": {
        "$schema": {
            "type": "string"
        },
        "id": {
            "type": "string"
        },
        "version": {
            "type": [
                "string",
                "number"
            ]
        },
        "title": {
            "type": "string"
        },
        "submit_button_text": {
            "type": "string"
        },
        "success": {
            "type": "object",
            "required": [
                "mode"
            ],
            "properties": {
                "mode": {
                    "enum": [
                        "inline",
                        "redirect"
                    ]
                },
                "redirect_url": {
                    "type": "string"
                },
                "message": {
                    "type": "string"
                }
            },
            "additionalProperties": false
        },
        "email": {
            "type": "object",
            "required": [
                "to",
                "subject"
            ],
            "properties": {
                "display_format_tel": {
                    "enum": [
                        "xxx-xxx-xxxx",
                        "(xxx) xxx-xxxx",
                        "xxx.xxx.xxxx"
                    ]
                },
                "to": {
                    "type": "string",
                    "minLength": 1
                },
                "subject": {
                    "type": "string",
                    "minLength": 1
                },
                "email_template": {
                    "type": "string"
                },
                "include_fields": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                }
            },
            "additionalProperties": false
        },
        "fields": {
            "type": "array",
            "items": {
                "$ref": "#/definitions/field"
            }
        },
        "rules": {
            "type": "array",
            "items": {
                "$ref": "#/definitions/rule"
            }
        }
    },
    "definitions": {
        "field": {
            "type": "object",
            "required": [
                "type"
            ],
            "additionalProperties": false,
            "properties": {
                "type": {
                    "enum": [
                        "name",
                        "first_name",
                        "last_name",
                        "text",
                        "email",
                        "textarea",
                        "textarea_html",
                        "url",
                        "tel",
                        "tel_us",
                        "number",
                        "range",
                        "date",
                        "zip",
                        "zip_us",
                        "select",
                        "radio",
                        "checkbox",
                        "file",
                        "files",
                        "row_group"
                    ]
                },
                "key": {
                    "type": "string"
                },
                "label": {
                    "type": "string"
                },
                "required": {
                    "type": "boolean"
                },
                "options": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/option"
                    }
                },
                "multiple": {
                    "type": "boolean"
                },
                "accept": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "before_html": {
                    "type": "string"
                },
                "after_html": {
                    "type": "string"
                },
                "class": {
                    "type": "string"
                },
                "placeholder": {
                    "type": "string"
                },
                "autocomplete": {
                    "type": "string"
                },
                "size": {
                    "type": "integer"
                },
                "max_length": {
                    "type": "integer"
                },
                "min": {
                    "type": [
                        "number",
                        "string"
                    ]
                },
                "max": {
                    "type": [
                        "number",
                        "string"
                    ]
                },
                "pattern": {
                    "type": "string"
                },
                "email_attach": {
                    "type": "boolean"
                },
                "max_file_bytes": {
                    "type": "integer"
                },
                "max_files": {
                    "type": "integer"
                },
                "step": {
                    "type": [
                        "number",
                        "string"
                    ]
                },
                "mode": {
                    "enum": [
                        "start",
                        "end"
                    ]
                },
                "tag": {
                    "enum": [
                        "div",
                        "section"
                    ]
                }
            },
            "allOf": [
                {
                    "if": {
                        "properties": {
                            "type": {
                                "enum": [
                                    "file",
                                    "files"
                                ]
                            }
                        },
                        "required": [
                            "type"
                        ]
                    },
                    "then": {
                        "properties": {
                            "accept": {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                {
                    "if": {
                        "properties": {
                            "type": {
                                "enum": [
                                    "files"
                                ]
                            }
                        },
                        "required": [
                            "type"
                        ]
                    },
                    "then": {
                        "properties": {
                            "max_files": {
                                "type": "integer",
                                "minimum": 1
                            }
                        }
                    }
                },
                {
                    "if": {
                        "properties": {
                            "type": {
                                "enum": [
                                    "text",
                                    "tel",
                                    "tel_us",
                                    "url",
                                    "email"
                                ]
                            }
                        },
                        "required": [
                            "type"
                        ]
                    },
                    "then": {
                        "properties": {
                            "size": {
                                "type": "integer",
                                "minimum": 1,
                                "maximum": 100
                            }
                        }
                    },
                    "else": {
                        "properties": {
                            "size": false
                        }
                    }
                },
                {
                    "if": {
                        "properties": {
                            "email_attach": {}
                        },
                        "required": [
                            "email_attach"
                        ]
                    },
                    "then": {
                        "properties": {
                            "type": {
                                "enum": [
                                    "file",
                                    "files"
                                ]
                            }
                        }
                    }
                }
            ]
        },
        "option": {
            "type": "object",
            "required": [
                "key",
                "label"
            ],
            "additionalProperties": false,
            "properties": {
                "key": {
                    "type": "string"
                },
                "label": {
                    "type": "string"
                },
                "disabled": {
                    "type": "boolean"
                }
            }
        },
        "rule": {
            "type": "object",
            "required": [
                "rule"
            ],
            "additionalProperties": false,
            "properties": {
                "rule": {
                    "enum": [
                        "required_if",
                        "required_if_any",
                        "required_unless",
                        "matches",
                        "one_of",
                        "mutually_exclusive"
                    ]
                },
                "field": {
                    "type": "string"
                },
                "fields": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "other": {
                    "type": "string"
                },
                "equals": {
                    "type": "string"
                },
                "equals_any": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                }
            }
        }
    }
}
