**Generated from `tools/spec_sources/security_data.yaml` â€” do not edit manually.**
<!-- BEGIN GENERATED: cookie-header-actions -->
| Flow trigger | Header action | Invariants |
|--------------|---------------|------------|
| <a id="sec-cookie-header-get-render"></a>GET render | `skip` | Renderer MUST NOT emit `Set-Cookie`; embed `/eforms/prime?f={form_id}[&s={slot}]` so `/eforms/prime` alone mints or refreshes the cookie before POST. |
| <a id="sec-cookie-header-prime"></a>`/eforms/prime` request | `conditional` | Only flow permitted to emit a positive `Set-Cookie` for `eforms_eid_{form_id}`; send it when minting or when no unexpired match was presented, and skip it when an identical unexpired cookie arrived. |
| <a id="sec-cookie-header-post-rerender"></a>POST rerender (NCID or challenge) | `deletion` | Error rerenders governed by the NCID rerender and challenge lifecycle MUST delete `eforms_eid_{form_id}` with a matching header that mirrors the minted Name/Path/SameSite/Secure/HttpOnly attributes (and Domain when minted), clears via `Max-Age=0` or an already-expired `Expires`, and embed `/eforms/prime?f={form_id}[&s={slot}]` in the rerender so the persisted record is reissued before the next POST; the rerender itself MUST NOT emit a positive header. Host-only mints omit Domain; the deletion header MUST match. |
| <a id="sec-cookie-header-challenge-success"></a>Challenge verification success | `deletion` | Verifier success response clears the cookie via a deletion header that mirrors the minted Name/Path/SameSite/Secure/HttpOnly attributes (and Domain when minted) and uses `Max-Age=0` or an already-expired `Expires`, then relies on the PRG redirect GET to embed `/eforms/prime`; NCID stays pinned per the rerender lifecycle. Host-only mints omit Domain; the deletion header MUST match. |
| <a id="sec-cookie-header-prg-redirect"></a>PRG redirect (success handoff) | `deletion` | All success PRG responses MUST delete `eforms_eid_{form_id}` before issuing the 303 using a header that mirrors the minted Name/Path/SameSite/Secure/HttpOnly attributes (and Domain when minted) with `Max-Age=0` or an already-expired `Expires`, so the follow-up GET reprovisions the cookie; flows covered by the NCID rerender and challenge lifecycle rely on that redirect GET to re-prime, and no positive header is permitted in PRG. Host-only mints omit Domain; the deletion header MUST match. |
<!-- END GENERATED: cookie-header-actions -->
